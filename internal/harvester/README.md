Code ported over from https://github.com/belgaied2/harvester-cli, heavily modified
